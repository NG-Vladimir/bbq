<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>–ú–∏–Ω–∏ BBQ/–ì—Ä–∏–ª—å | Telegram MiniApp</title>
  <link rel="stylesheet" href="style.css" />
  <script src="https://telegram.org/js/telegram-web-app.js"></script>
  <style>
    /* –ù–µ–±–æ–ª—å—à–∏–µ —É—Ç–∏–ª–∏—Ç–∞—Ä–Ω—ã–µ —Å—Ç–∏–ª–∏ –¥–ª—è –Ω–æ–≤—ã—Ö —Ñ–æ—Ä–º (–Ω–µ –º–µ–Ω—è—é—Ç —Ç–≤–æ–π CSS) */
    .overlay-form { position: fixed; inset: 0; display:flex;align-items:center;justify-content:center;background: rgba(0,0,0,0.35); z-index:50; }
    .form-card { background:#fff;border-radius:16px;padding:18px; width:92%; max-width:420px; box-shadow:0 8px 30px rgba(0,0,0,0.15); }
    .form-row{margin-bottom:10px}
    .form-row label{display:block;font-size:13px;color:#333;margin-bottom:6px}
    .form-row input, .form-row select{width:100%;padding:10px;border-radius:10px;border:1px solid #e6e6e6;font-size:15px}
    .primary-btn{display:inline-block;width:100%;padding:12px;border-radius:12px;border:none;background:#255af2;color:#fff;font-weight:600;cursor:pointer}
    .muted{color:#7a7a7a;font-size:13px;margin-top:8px;text-align:center}
    .small-btn{display:inline-block;padding:8px 10px;border-radius:10px;border:1px solid #ddd;background:#fff;cursor:pointer}
  </style>
</head>
<body>

<div class="container" id="app-container">

  <div class="tabs" id="tabs">
    <button class="tab-btn active" data-cat="BBQ">BBQ</button>
    <button class="tab-btn" data-cat="–ì–†–ò–õ–¨">–ì—Ä–∏–ª—å</button>
    <button class="tab-btn" data-cat="–°–û–£–°–´">–°–æ—É—Å—ã</button>
  </div>

  <h2 class="app-title" id="cat-title">–ú–µ–Ω—é BBQ</h2>

  <div id="products-section">
    <div class="products-list" id="products-list"></div>
    <button id="show-all-btn" class="show-all-btn">–ü–æ–∫–∞–∑–∞—Ç—å –≤—Å—ë –º–µ–Ω—é</button>
  </div>

  <button class="cart-btn" id="cart-btn" disabled>
    –ö–æ—Ä–∑–∏–Ω–∞ <span class="cart-count" id="cart-count">(0)</span>
  </button>

  <!-- –ö–û–†–ó–ò–ù–ê -->
  <div id="cart-modal" class="cart-modal" style="display:none;">
    <div class="cart-content" role="dialog" aria-modal="true">
      <h3>–ö–æ—Ä–∑–∏–Ω–∞</h3>
      <div id="cart-items"></div>
      <div class="cart-total-row">
        <span>–°—É–º–º–∞ –∑–∞–∫–∞–∑–∞:</span>
        <span id="cart-total-sum">0 —Ä—É–±</span>
      </div>
      <button class="confirm-btn" id="confirm-btn">–û—Ñ–æ—Ä–º–∏—Ç—å ‚Äî –≤—ã–±—Ä–∞—Ç—å –¥–∞—Ç—É/–≤—Ä–µ–º—è</button>
      <button class="close-cart-btn" id="close-cart-btn">–ó–∞–∫—Ä—ã—Ç—å</button>
    </div>
  </div>

  <!-- –í–´–ë–û–† –î–ê–¢–´ / –í–†–ï–ú–ï–ù–ò (–ø–µ—Ä–µ–¥ –æ—Ç–ø—Ä–∞–≤–∫–æ–π) -->
  <div id="datetime-modal" class="cart-modal" style="display:none;">
    <div class="cart-content">
      <h3>–í—ã–±–µ—Ä–∏—Ç–µ –¥–∞—Ç—É –∏ –≤—Ä–µ–º—è</h3>
      <div style="margin-top:8px;">
        <div class="form-row">
          <label for="pick-date">–î–∞—Ç–∞</label>
          <input id="pick-date" type="date" />
        </div>
        <div class="form-row">
          <label for="pick-time">–í—Ä–µ–º—è</label>
          <input id="pick-time" type="time" />
        </div>
        <div class="form-row">
          <label for="note">–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ (–Ω–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ)</label>
          <input id="note" type="text" placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä: –±–µ–∑ –ª—É–∫–∞, –ø–æ–±–æ–ª—å—à–µ —Å–æ—É—Å–∞" />
        </div>
      </div>
      <button id="send-order-btn" class="primary-btn">–ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç—å –∏ –æ—Ç–ø—Ä–∞–≤–∏—Ç—å –∑–∞–∫–∞–∑</button>
      <button class="close-cart-btn">–û—Ç–º–µ–Ω–∞</button>
    </div>
  </div>

  <!-- –°–ü–ê–°–ò–ë–û -->
  <div id="thanks-modal" class="cart-modal" style="display:none;">
    <div class="cart-content">
      <h3>–°–ø–∞—Å–∏–±–æ!</h3>
      <p id="thanks-text">–í–∞—à –∑–∞–∫–∞–∑ —É—Å–ø–µ—à–Ω–æ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω üëå</p>
      <button class="close-cart-btn" onclick="window.Telegram.WebApp.close()">–ó–∞–∫—Ä—ã—Ç—å MiniApp</button>
    </div>
  </div>

</div>

<!-- –§–æ—Ä–º–∞ —Å–±–æ—Ä–∞ –§–ò–û/—Ç–µ–ª–µ—Ñ–æ–Ω–∞ –ø—Ä–∏ –ø–µ—Ä–≤–æ–º –≤—Ö–æ–¥–µ -->
<div id="user-info-overlay" class="overlay-form" style="display:none;">
  <div class="form-card">
    <h3 style="margin-top:0;margin-bottom:8px">–ü–∞—Ä–∞ —Å–ª–æ–≤ –æ –≤–∞—Å</h3>
    <div class="form-row">
      <label for="user-first">–ò–º—è</label>
      <input id="user-first" type="text" placeholder="–ò–≤–∞–Ω" />
    </div>
    <div class="form-row">
      <label for="user-last">–§–∞–º–∏–ª–∏—è</label>
      <input id="user-last" type="text" placeholder="–ò–≤–∞–Ω–æ–≤" />
    </div>
    <div class="form-row">
      <label for="user-phone">–¢–µ–ª–µ—Ñ–æ–Ω</label>
      <input id="user-phone" type="tel" placeholder="+7 999 000-00-00" />
    </div>
    <button id="save-user-btn" class="primary-btn">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å –∏ –ø—Ä–æ–¥–æ–ª–∂–∏—Ç—å</button>
    <div class="muted">–î–∞–Ω–Ω—ã–µ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è —Ç–æ–ª—å–∫–æ –≤ —ç—Ç–æ–º —É—Å—Ç—Ä–æ–π—Å—Ç–≤–µ –∏ –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –¥–ª—è –æ—Ñ–æ—Ä–º–ª–µ–Ω–∏—è –∑–∞–∫–∞–∑–∞.</div>
  </div>
</div>

<script>
/* ========== –ù–∞—Å—Ç—Ä–æ–π–∫–∏ ========== */
const SERVER_URL = 'https://–í–ê–®-–ü–£–ë–õ–ò–ß–ù–´–ô-SERVER/order'; // <- –≤—Å—Ç–∞–≤—å —Å—é–¥–∞ —Å–≤–æ–π –ø—É–±–ª–∏—á–Ω—ã–π URL
const tg = window.Telegram.WebApp;
tg.ready();

/* ========== –î–∞–Ω–Ω—ã–µ –º–µ–Ω—é ========== */
const MENU = [
  { category: 'BBQ', items: [
    { name: '–ì–æ–≤—è–¥–∏–Ω–∞ (—Ä–≤–∞–Ω–æ–µ –º—è—Å–æ)', price: 8.5, unit: '100–≥' },
    { name: '–ì–æ–≤—è–∂–∏–π —è–∑—ã–∫', price: 9.5, unit: '100–≥' },
    { name: '–ë—É–∂–µ–Ω–∏–Ω–∞ (—à–µ—è)', price: 7.5, unit: '100–≥' },
    { name: '–°–≤–∏–Ω–∏–Ω–∞ (—Ä–≤–∞–Ω–æ–µ –º—è—Å–æ)', price: 6.5, unit: '100–≥' },
    { name: '–†—ë–±—Ä—ã—à–∫–∏ (—Ç–æ–ª—Å—Ç—ã–µ)', price: 8, unit: '100–≥' },
    { name: '–†—ë–±—Ä—ã—à–∫–∏ (–º—è—Å–Ω—ã–µ)', price: 5, unit: '100–≥' },
    { name: '–†—É–ª—å–∫–∞ (—Å–≤–∏–Ω–∏–Ω–∞)', price: 5, unit: '100–≥' },
    { name: '–ö—É—Ä–∏–Ω–æ–µ (–º—è—Å–æ)', price: 5.5, unit: '100–≥' },
    { name: '–ò–Ω–¥–µ–π–∫–∞ (–±–µ–¥—Ä–æ)', price: 7, unit: '100–≥' },
    { name: '–ò–Ω–¥–µ–π–∫–∞ (–≥–æ–ª–µ–Ω—å)', price: 6, unit: '100–≥' },
    { name: '–ú—è—Å–æ –∏–Ω–¥–µ–π–∫–∏', price: 9, unit: '100–≥' },
    { name: '–£—Ç–∫–∞ —Å –∑–∞–ø–µ—á. —è–±–ª.', price: 7, unit: '100–≥' },
  ] },
  { category: '–ì–†–ò–õ–¨', items: [
    { name: '–ê–≤—Ç–æ—Ä—Å–∫–∏–π —à–∞—à–ª—ã–∫ (—à–µ—è)', price: 7, unit: '100–≥' },
    { name: '–†—ë–±—Ä—ã—à–∫–∏ (—Å–≤–∏–Ω—ã–µ)', price: 7, unit: '100–≥' },
    { name: '–ö—É—Ä–∏–Ω—ã–µ (—á—É–ø–∞-—á—É–ø—Å—ã) –≤ —Ñ. —Å–æ—É—Å–µ', price: 6, unit: '100–≥' },
    { name: '–ö—É—Ä–∏–Ω—ã–µ –∫—Ä—ã–ª—ã—à–∫–∏', price: 6, unit: '100–≥' },
    { name: '–ö—É—Ä–∏–Ω—ã–µ —Å–µ—Ä–¥–µ—á–∫–∏', price: 6, unit: '100–≥' },
    { name: '–î–æ–º–∞—à–Ω–∏–µ –∫–æ–ª–±–∞—Å–∫–∏', price: 7, unit: '100–≥' },
  ] },
  { category: '–°–û–£–°–´', items: [
    { name: '–ë–∞—Ä–±–µ–∫—é', price: 4, unit: '50–≥' },
    { name: '–§–∏—Ä–º–µ–Ω–Ω—ã–π —Å—ã—Ä–Ω—ã–π', price: 4, unit: '50–≥' },
    { name: '–ß–∏–ª–∏ —Å–ª–∞–¥–∫–∏–π', price: 4, unit: '50–≥' },
  ] }
];

const SHORT_LIMIT = 3;
let cart = {};
let currentCat = 'BBQ';
let allMenuShown = false;

/* ========== –£—Ç–∏–ª–∏—Ç—ã ========== */
function itemKey(item){ return `${item.name}|${item.price}|${item.unit}`; }
function findItemByKey(key){ for(const cat of MENU) for(const it of cat.items) if(itemKey(it)===key) return {...it, category:cat.category}; }

/* ========== –†–µ–Ω–¥–µ—Ä –≤–∫–ª–∞–¥–æ–∫ –∏ —Ç–æ–≤–∞—Ä–æ–≤ ========== */
function renderTabs(){
  document.querySelectorAll('.tab-btn').forEach(btn => btn.classList.toggle('active', btn.dataset.cat === currentCat));
}
function renderProducts(){
  const sectionTitle = document.getElementById('cat-title');
  sectionTitle.textContent = `–ú–µ–Ω—é ${currentCat}`;
  const list = document.getElementById('products-list');
  list.innerHTML = '';
  const cat = MENU.find(c=>c.category===currentCat);
  const items = allMenuShown?cat.items:cat.items.slice(0,SHORT_LIMIT);
  items.forEach(item=>{
    const card=document.createElement('div'); card.className='product-card';
    card.innerHTML=`
      <div class="product-info">
        <div class="product-name">${item.name}</div>
        <div class="product-meta">${item.price} —Ä—É–±/${item.unit}</div>
      </div>
      <div class="product-amount">
        <button class="btn minus" ${!cart[itemKey(item)]?'disabled':''}>-</button>
        <span class="amount">${cart[itemKey(item)]||0}</span>
        <button class="btn plus">+</button>
      </div>
    `;
    const minus=card.querySelector('.minus');
    const plus=card.querySelector('.plus');
    plus.onclick=()=>{ cart[itemKey(item)]=(cart[itemKey(item)]||0)+1; renderProducts(); updateCartBtn(); };
    minus.onclick=()=>{ if(cart[itemKey(item)]){ cart[itemKey(item)]--; if(cart[itemKey(item)]<=0) delete cart[itemKey(item)]; renderProducts(); updateCartBtn(); } };
    list.appendChild(card);
  });
  document.getElementById('show-all-btn').style.display=(!allMenuShown&&cat.items.length>SHORT_LIMIT)?'block':'none';
}

/* ========== –°–æ–±—ã—Ç–∏—è –≤–∫–ª–∞–¥–æ–∫ ========== */
document.getElementById('show-all-btn').onclick=()=>{ allMenuShown=true; renderProducts(); renderTabs(); };
document.querySelectorAll('.tab-btn').forEach(btn=>{ btn.onclick=()=>{ currentCat=btn.dataset.cat; allMenuShown=false; renderTabs(); renderProducts(); }; });

/* ========== –ö–Ω–æ–ø–∫–∞ –∫–æ—Ä–∑–∏–Ω—ã ========== */
function updateCartBtn(){
  let total=Object.values(cart).reduce((a,b)=>a+b,0);
  document.getElementById('cart-count').textContent=`(${total})`;
  document.getElementById('cart-btn').disabled=total===0;
}
document.getElementById('cart-btn').onclick = ()=>{
  renderCart();
  document.getElementById('cart-modal').style.display='flex';
};

/* ========== –†–ï–ù–î–ï–† –ö–û–†–ó–ò–ù–´ ========== */
function renderCart(){
  const cartItemsDiv = document.getElementById('cart-items');
  cartItemsDiv.innerHTML = '';

  if(Object.keys(cart).length === 0){
    cartItemsDiv.innerHTML = '<p>–ö–æ—Ä–∑–∏–Ω–∞ –ø—É—Å—Ç–∞</p>';
    document.getElementById('cart-total-sum').textContent = '0 —Ä—É–±';
    return;
  }

  Object.entries(cart).forEach(([key, amount])=>{
    const item = findItemByKey(key);
    if(!item) return;

    const row = document.createElement('div');
    row.className = 'cart-row';
    row.innerHTML=`
      <div class="cart-item-title">${item.name} <div style="font-size:12px;color:#9aa1b2;margin-top:4px">${item.category}</div></div>
      <div class="cart-edit">
        <button class="btn minus">-</button>
        <div class="amount">${amount}</div>
        <button class="btn plus">+</button>
        <button class="btn remove" title="–£–¥–∞–ª–∏—Ç—å">‚úï</button>
      </div>
      <div class="cart-item-sum">${(item.price * amount).toFixed(2)} —Ä—É–±</div>
    `;

    const minusBtn = row.querySelector('.minus');
    const plusBtn = row.querySelector('.plus');
    const removeBtn = row.querySelector('.remove');

    minusBtn.onclick = ()=>{
      cart[key]--;
      if(cart[key] <= 0) delete cart[key];
      renderCart();
      renderProducts();
      updateCartBtn();
    };
    plusBtn.onclick = ()=>{
      cart[key]++;
      renderCart();
      renderProducts();
      updateCartBtn();
    };
    removeBtn.onclick = ()=>{
      delete cart[key];
      renderCart();
      renderProducts();
      updateCartBtn();
    };

    cartItemsDiv.appendChild(row);
  });

  const total = Object.entries(cart).reduce((sum,[key, amount])=>{
    const item = findItemByKey(key);
    return sum + item.price * amount;
  },0);
  document.getElementById('cart-total-sum').textContent = total.toFixed(2) + ' —Ä—É–±';
}

/* ========== –£–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω–∞—è –ª–æ–≥–∏–∫–∞ –∑–∞–∫—Ä—ã—Ç–∏—è –º–æ–¥–∞–ª–æ–∫ ========== */
function closeAllModals(){
  document.querySelectorAll('.cart-modal').forEach(m=>m.style.display='none');
  document.getElementById('user-info-overlay').style.display='none';
}
document.addEventListener('click', (e)=>{
  if(e.target.matches('.close-cart-btn')) closeAllModals();
});

/* ========== –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–µ –¥–∞–Ω–Ω—ã–µ (—Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ) ========== */
const USER_STORAGE_KEY = 'miniapp_user_v1';
function getStoredUser(){
  try { return JSON.parse(localStorage.getItem(USER_STORAGE_KEY)); } catch(e){ return null; }
}
function storeUser(obj){
  localStorage.setItem(USER_STORAGE_KEY, JSON.stringify(obj));
}

/* –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —Ñ–æ—Ä–º—É —Å –∑–∞–ø—Ä–æ—Å–æ–º –§–ò–û/—Ç–µ–ª–µ—Ñ–æ–Ω–∞, –µ—Å–ª–∏ –Ω–µ—Ç –¥–∞–Ω–Ω—ã—Ö */
function ensureUserInfoThen(callback){
  const existing = getStoredUser();
  if(existing && existing.phone) return callback(existing);
  // –ø–æ–∫–∞–∑–∞—Ç—å –æ–≤–µ—Ä–ª–µ–π
  document.getElementById('user-info-overlay').style.display = 'flex';
  // prefill from tg.initDataUnsafe if possible
  const u = tg.initDataUnsafe?.user || {};
  if(u.first_name) document.getElementById('user-first').value = u.first_name;
  if(u.last_name) document.getElementById('user-last').value = u.last_name;

  document.getElementById('save-user-btn').onclick = ()=>{
    const first = document.getElementById('user-first').value.trim();
    const last = document.getElementById('user-last').value.trim();
    const phone = document.getElementById('user-phone').value.trim();
    if(!first || !phone){ alert('–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –≤–≤–µ–¥–∏—Ç–µ –∏–º—è –∏ —Ç–µ–ª–µ—Ñ–æ–Ω.'); return; }
    const obj = { first, last, phone };
    storeUser(obj);
    document.getElementById('user-info-overlay').style.display = 'none';
    if(typeof callback === 'function') callback(obj);
  };
}

/* ========== –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –∑–∞–∫–∞–∑–∞ –∏ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –∏–º–µ–Ω–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è ========== */
function resolveUsername(){
  // —Ü–µ–ø–æ—á–∫–∞: username -> first+last -> id -> "–ê–Ω–æ–Ω–∏–º"
  const initUser = tg.initDataUnsafe?.user || {};
  const username = initUser.username;
  if(username) return '@' + username;
  const name = [initUser.first_name, initUser.last_name].filter(Boolean).join(' ').trim();
  if(name) return name;
  if(initUser.id) return 'id:' + initUser.id;
  return '–ê–Ω–æ–Ω–∏–º';
}

/* ========== –ü—Ä–æ—Ü–µ—Å—Å –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è (—à–∞–≥ 1: –ø–æ–∫–∞–∑–∞—Ç—å –¥–∞—Ç—É/–≤—Ä–µ–º—è) ========== */
document.getElementById('confirm-btn').onclick = ()=>{
  if(Object.keys(cart).length===0){ alert('–ö–æ—Ä–∑–∏–Ω–∞ –ø—É—Å—Ç–∞'); return; }
  ensureUserInfoThen(()=> {
    // –æ—Ç–∫—Ä—ã—Ç—å modal –≤—ã–±–æ—Ä–∞ –¥–∞—Ç—ã/–≤—Ä–µ–º–µ–Ω–∏
    document.getElementById('datetime-modal').style.display = 'flex';
    // –ø—Ä–µ–¥—É—Å—Ç–∞–Ω–æ–≤–∏–º —Å–µ–≥–æ–¥–Ω—è—à–Ω—é—é –¥–∞—Ç—É + –≤—Ä–µ–º—è —á–µ—Ä–µ–∑ 30 –º–∏–Ω
    const dateInput = document.getElementById('pick-date');
    const timeInput = document.getElementById('pick-time');
    const now = new Date();
    const in30 = new Date(now.getTime() + 30*60000);
    dateInput.value = in30.toISOString().slice(0,10);
    timeInput.value = in30.toTimeString().slice(0,5);
  });
};

/* ========== –û—Ç–ø—Ä–∞–≤–∫–∞ –∑–∞–∫–∞–∑–∞ –Ω–∞ —Å–µ—Ä–≤–µ—Ä (—à–∞–≥ 2) ========== */
document.getElementById('send-order-btn').onclick = async ()=>{
  const date = document.getElementById('pick-date').value;
  const time = document.getElementById('pick-time').value;
  const note = document.getElementById('note').value.trim();
  if(!date || !time){ alert('–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –≤—ã–±–µ—Ä–∏—Ç–µ –¥–∞—Ç—É –∏ –≤—Ä–µ–º—è.'); return; }

  // —Å–æ–±–∏—Ä–∞–µ–º –ø–æ–∑–∏—Ü–∏–∏
  const items = [];
  Object.entries(cart).forEach(([key,amount])=>{
    const item = findItemByKey(key);
    if(item && amount>0) items.push({ name:item.name, price:item.price, unit:item.unit, count:amount, category:item.category });
  });
  const total = items.reduce((s,it)=>s + it.price*it.count, 0);

  // –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–µ –¥–∞–Ω–Ω—ã–µ: —Å–Ω–∞—á–∞–ª–∞ –ª–æ–∫–∞–ª—å–Ω—ã–µ, –ø–æ—Ç–æ–º tg
  const localUser = getStoredUser() || {};
  const resolvedTg = resolveUsername();
  const fullname = (localUser.first && localUser.last) ? (localUser.first + ' ' + localUser.last) : (resolvedTg || '–ê–Ω–æ–Ω–∏–º');
  const phone = localUser.phone || '';

  const order = {
    items,
    total,
    user: resolvedTg,
    fullname,
    phone,
    pickup_date: date,
    pickup_time: time,
    note
  };

  // –æ—Ç–ø—Ä–∞–≤–∫–∞
  try {
    const resp = await fetch(SERVER_URL, {
      method: 'POST',
      headers: { 'Content-Type': 'application/json' },
      body: JSON.stringify(order)
    });
    if(!resp.ok) throw new Error('–°–µ—Ä–≤–µ—Ä –≤–µ—Ä–Ω—É–ª ' + resp.status);
    // —É—Å–ø–µ—Ö
    closeAllModals();
    document.getElementById('thanks-text').textContent = `–°–ø–∞—Å–∏–±–æ, ${localUser.first || resolvedTg}! –í–∞—à –∑–∞–∫–∞–∑ –Ω–∞ ${date} –≤ ${time} –ø—Ä–∏–Ω—è—Ç.`;
    document.getElementById('thanks-modal').style.display = 'flex';
    // —á–∏—Å—Ç–∏–º –∫–æ—Ä–∑–∏–Ω—É
    cart = {};
    renderProducts();
    updateCartBtn();
  } catch(err){
    alert('–û—à–∏–±–∫–∞ –æ—Ç–ø—Ä–∞–≤–∫–∏ –∑–∞–∫–∞–∑–∞: ' + err.message);
  }
};

/* ========== –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è ‚Äî –∑–∞–∫—Ä—ã—Ç–∏–µ –º–æ–¥–∞–ª–æ–∫ –∏ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ ========== */
window.onload = ()=>{
  renderTabs();
  renderProducts();
  updateCartBtn();

  // –∫–Ω–æ–ø–∫–∞ –∑–∞–∫—Ä—ã—Ç–∏—è –Ω–∞ overlay / –º–æ–¥–∞–ª–∫–∞—Ö ‚Äî —É–∂–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∞ –≥–ª–æ–±–∞–ª—å–Ω–æ (–¥–µ–ª–µ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ)
  // –∑–∞—â–∏—Ç–∞ –æ—Ç –∞–≤—Ç–æ-–ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è –≤–Ω–µ—à–Ω–∏—Ö —Å—Å—ã–ª–æ–∫ ‚Äî –º—ã –Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ–º –Ω–∏–∫–∞–∫–∏—Ö –≤–Ω–µ—à–Ω–∏—Ö –≤—ã–∑–æ–≤–æ–≤

  // –¥–æ–±–∞–≤–∏–º –æ–±—Ä–∞–±–æ—Ç–∫—É ESC –¥–ª—è –∑–∞–∫—Ä—ã—Ç–∏—è –º–æ–¥–∞–ª–æ–∫
  document.addEventListener('keydown', e=>{
    if(e.key === 'Escape') closeAllModals();
  });
};
</script>

</body>
</html>